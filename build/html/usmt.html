
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>User State Migration Tool ‘USMT’ &#8212; Base de Conhecimento 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Dicas de bash, linha de comando para uso diário." href="bash.html" />
    <link rel="prev" title="Router Juniper" href="juniper.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="bash.html" title="Dicas de bash, linha de comando para uso diário."
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="juniper.html" title="Router Juniper"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Base de Conhecimento 0.0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">User State Migration Tool ‘USMT’</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="user-state-migration-tool-usmt">
<h1>User State Migration Tool ‘USMT’<a class="headerlink" href="#user-state-migration-tool-usmt" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Ferramenta de Migração de Estado do Usuário é um programa utilitário de linha de comando desenvolvido pela Microsoft que permite que os usuários se sintam à vontade com linguagens de script para transferir arquivos e configurações entre PCs com Windows.</p>
</div>
<section id="procedimento">
<h2>Procedimento<a class="headerlink" href="#procedimento" title="Permalink to this headline">¶</a></h2>
<p>Instalação:</p>
<p>Baixe o adksetup.exe pelo site: <a class="reference external" href="https://docs.microsoft.com/en-us/windows-hardware/get-started/adk-install">docs.microsoft.com</a></p>
<p><strong>Observação:</strong> Nesse exemplo usaremos windows adk, para sistema windows 10 professional.</p>
<p>Após a execução do <strong>adksetup.exe</strong> vamos escolher a segunda opção: <strong>download features for installation on a separate computer.</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Escolha o local de instalação em <strong>C:\ADK-Offline</strong>, e após o seu download, copie esta pasta para um pendrive, pois iremos usá-la para instalar em máquinas sem necessidade de conexão com a internet, manteremos tudo no modo offline.</p>
</div>
</section>
<section id="instalar-o-usmt">
<h2>Instalar o USMT<a class="headerlink" href="#instalar-o-usmt" title="Permalink to this headline">¶</a></h2>
<p>Entre na pasta ADK-Offline e execute o adksetup.exe e coloque no local de instalação o caminho:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">:</span>\<span class="n">ADK</span>
</pre></div>
</div>
<p>Escolha a primeira opção e em seguida selecione a ferramenta no caso, apenas o usmt.</p>
</section>
<section id="iniciar-o-processo-do-usmt-na-maquina-alvo">
<h2>Iniciar o processo do usmt na máquina alvo<a class="headerlink" href="#iniciar-o-processo-do-usmt-na-maquina-alvo" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>O teste à seguir foi feito no meu Oracle VM VirtualBOX</p>
</div>
<p>Mapear a pasta compartilhada o qual irar armazenar o perfil do usuário:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">net</span> <span class="n">use</span> <span class="n">e</span><span class="p">:</span> \\<span class="n">vboxsrv</span>\<span class="n">andre</span>

<span class="n">mkdir</span> <span class="n">e</span><span class="p">:</span>\<span class="n">Downloads</span>\<span class="n">backup_user</span>
</pre></div>
</div>
<p>Iniciar o processo do usmt:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="s2">&quot;C:\ADK\Assessment and Deployment Kit\User State Migration Tool</span><span class="se">\a</span><span class="s2">md64&quot;</span>

<span class="n">scanstate</span><span class="o">.</span><span class="n">exe</span> <span class="n">e</span><span class="p">:</span>\<span class="n">Downloads</span>\<span class="n">backup_user</span> <span class="o">/</span><span class="n">ue</span><span class="p">:</span><span class="o">*</span>\<span class="o">*</span> <span class="o">/</span><span class="n">ui</span><span class="p">:</span><span class="o">*</span>\<span class="n">andre</span> <span class="o">/</span><span class="n">i</span><span class="p">:</span><span class="n">miguser</span><span class="o">.</span><span class="n">xml</span> <span class="o">/</span><span class="n">i</span><span class="p">:</span><span class="n">migapp</span><span class="o">.</span><span class="n">xml</span> <span class="o">/</span><span class="n">o</span> <span class="o">/</span><span class="n">c</span> <span class="o">/</span><span class="n">nocompress</span>

<span class="n">ou</span>

<span class="n">scanstate</span><span class="o">.</span><span class="n">exe</span> \\<span class="n">vboxsrv</span>\<span class="n">andre</span>\<span class="n">Downloads</span>\<span class="n">backup_user</span> <span class="o">/</span><span class="n">ue</span><span class="p">:</span><span class="o">*</span>\<span class="o">*</span> <span class="o">/</span><span class="n">ui</span><span class="p">:</span><span class="o">*</span>\<span class="n">andre</span> <span class="o">/</span><span class="n">i</span><span class="p">:</span><span class="n">miguser</span><span class="o">.</span><span class="n">xml</span> <span class="o">/</span><span class="n">i</span><span class="p">:</span><span class="n">migapp</span><span class="o">.</span><span class="n">xml</span> <span class="o">/</span><span class="n">o</span> <span class="o">/</span><span class="n">c</span> <span class="o">/</span><span class="n">nocompress</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/capture-1-scanstate.png"><img alt="Snipping Tool Capture Scanstate" src="_images/capture-1-scanstate.png" style="width: 511.79999999999995px; height: 251.39999999999998px;" /></a>
</figure>
<p><strong>OBS</strong>: Isso Irá criar uma pasta nova chamada <strong>USMT</strong> em e:\Downloads\backup_user.</p>
<p>Restore do perfil em outra máquina, instale o ADK (não esqueça de selecionar apenas o usmt):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="s2">&quot;C:\ADK\Assessment and Deployment Kit\User State Migration Tool</span><span class="se">\a</span><span class="s2">md64&quot;</span>

<span class="n">loadstate</span> <span class="n">e</span><span class="p">:</span>\<span class="n">Downloads</span>\<span class="n">backup_user</span> <span class="o">/</span><span class="n">ue</span><span class="p">:</span><span class="o">*</span>\<span class="o">*</span> <span class="o">/</span><span class="n">ui</span><span class="p">:</span><span class="o">*</span>\<span class="n">andre</span> <span class="o">/</span><span class="n">i</span><span class="p">:</span><span class="n">miguser</span><span class="o">.</span><span class="n">xml</span> <span class="o">/</span><span class="n">i</span><span class="p">:</span><span class="n">migapp</span><span class="o">.</span><span class="n">xml</span> <span class="o">/</span><span class="n">nocompress</span>

<span class="n">ou</span>

<span class="n">loadstate</span><span class="o">.</span><span class="n">exe</span> \\<span class="n">vboxsrv</span>\<span class="n">andre</span>\<span class="n">Downloads</span>\<span class="n">backup_user</span>\<span class="n">USMT</span>\ <span class="o">/</span><span class="n">ue</span><span class="p">:</span><span class="o">*</span>\<span class="o">*</span> <span class="o">/</span><span class="n">ui</span><span class="p">:</span><span class="o">*</span>\<span class="n">andre</span> <span class="o">/</span><span class="n">i</span><span class="p">:</span><span class="n">miguser</span><span class="o">.</span><span class="n">xml</span> <span class="o">/</span><span class="n">i</span><span class="p">:</span><span class="n">migapp</span><span class="o">.</span><span class="n">xml</span> <span class="o">/</span><span class="n">nocompress</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/capture-2-loadstate.png"><img alt="Snipping Tool Capture Loadstate" src="_images/capture-2-loadstate.png" style="width: 578.4px; height: 189.0px;" /></a>
</figure>
<p>Faça um logon com o usuário andre e veja se tudo está ok (email, imagens, documentos, favoritos, icones, atalhos e etc..).</p>
</section>
</section>
<section id="consideracoes-finais">
<h1>Considerações Finais<a class="headerlink" href="#consideracoes-finais" title="Permalink to this headline">¶</a></h1>
<p>No windows 8.1 professional, foi necessário reconfigurar o wallpaper e a foto do login do usuário… mas do resto, como ícones e área de trabalho estavam OK! bem como emails, docs e images.</p>
<p>Caso a máquina esteja ingressado num Domain, tanto a máquina alvo como a de destino, devem estar sempre no mesmo domain ou grupo de trabalho, antes de se iniciar o restore do loadstate do perfil do usuário!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Caso queira utilizar a migração com mais segurança, podemos usar a criptografia.</p>
</div>
</section>
<section id="veja-um-exemplo-abaixo">
<h1>Veja um exemplo abaixo<a class="headerlink" href="#veja-um-exemplo-abaixo" title="Permalink to this headline">¶</a></h1>
<p>Migração completa do perfil do usuário chamado <strong>karen</strong>, no windows 10 x64 (hostname notedell). iremos migrá-la para outra máquina, tbm com windows 10 x64 e (hostname note-sam).</p>
<section id="realizar-a-copia-critografada-do-perfil-completo-da-maquina">
<h2>Realizar a cópia critografada do perfil completo da máquina.<a class="headerlink" href="#realizar-a-copia-critografada-do-perfil-completo-da-maquina" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Instale o software <strong>adksetup.exe</strong> em ambas as máquinas!</p></li>
</ol>
<p>(notedell):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">elevate</span> <span class="n">cmd</span> <span class="n">administrator</span>

<span class="n">cd</span> <span class="n">C</span><span class="p">:</span>\<span class="n">User</span> <span class="n">State</span> <span class="n">Migration</span> <span class="n">Tool</span>\<span class="n">arm64</span>

<span class="n">conecte</span> <span class="n">o</span> <span class="n">hd</span> <span class="n">externo</span> <span class="p">(</span><span class="n">e</span><span class="p">:)</span> <span class="n">ou</span> <span class="n">se</span> <span class="n">estiver</span> <span class="n">em</span> <span class="n">rede</span> <span class="n">mapeia</span> <span class="n">para</span> <span class="n">o</span> <span class="n">seu</span> <span class="n">fileserver</span><span class="p">:</span>

<span class="n">mkdir</span> <span class="n">e</span><span class="p">:</span>\<span class="n">notekaren</span>\<span class="n">perfilmigration</span>

<span class="n">scanstate</span><span class="o">.</span><span class="n">exe</span> <span class="n">e</span><span class="p">:</span>\<span class="n">notekaren</span>\<span class="n">perfilmigration</span> <span class="o">/</span><span class="n">ue</span><span class="p">:</span><span class="o">*</span>\<span class="o">*</span> <span class="o">/</span><span class="n">ui</span><span class="p">:</span><span class="o">*</span>\<span class="n">karen</span> <span class="o">/</span><span class="n">i</span><span class="p">:</span><span class="n">migapp</span><span class="o">.</span><span class="n">xml</span> <span class="o">/</span><span class="n">i</span><span class="p">:</span><span class="n">miguser</span><span class="o">.</span><span class="n">xml</span> <span class="o">/</span><span class="n">i</span><span class="p">:</span><span class="n">migdocs</span><span class="o">.</span><span class="n">xml</span> <span class="o">/</span><span class="n">v</span><span class="p">:</span><span class="mi">5</span> <span class="o">/</span><span class="n">vsc</span> <span class="o">/</span><span class="n">encrypt</span> <span class="o">/</span><span class="n">key</span><span class="p">:</span><span class="n">delldakaren10</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Restaurar o perfil em outra máquina.</p></li>
</ol>
<p>(note-sam):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">elevate</span> <span class="n">cmd</span> <span class="n">administrator</span>

<span class="n">cd</span> <span class="n">C</span><span class="p">:</span>\<span class="n">User</span> <span class="n">State</span> <span class="n">Migration</span> <span class="n">Tool</span>\<span class="n">arm64</span>

<span class="n">conecte</span> <span class="n">o</span> <span class="n">hd</span> <span class="n">externo</span> <span class="p">(</span><span class="n">e</span><span class="p">:)</span> <span class="n">ou</span> <span class="n">se</span> <span class="n">estiver</span> <span class="n">em</span> <span class="n">rede</span> <span class="n">mapeia</span> <span class="n">para</span> <span class="n">o</span> <span class="n">seu</span> <span class="n">fileserver</span><span class="p">:</span>

<span class="n">loadstate</span><span class="o">.</span><span class="n">exe</span> <span class="n">e</span><span class="p">:</span>\<span class="n">notekaren</span>\<span class="n">perfilmigration</span> <span class="o">/</span><span class="n">ue</span><span class="p">:</span><span class="o">*</span>\<span class="o">*</span> <span class="o">/</span><span class="n">ui</span><span class="p">:</span><span class="o">*</span>\<span class="n">karen</span> <span class="o">/</span><span class="n">i</span><span class="p">:</span><span class="n">migapp</span><span class="o">.</span><span class="n">xml</span> <span class="o">/</span><span class="n">i</span><span class="p">:</span><span class="n">miguser</span><span class="o">.</span><span class="n">xml</span> <span class="o">/</span><span class="n">i</span><span class="p">:</span><span class="n">migdocs</span><span class="o">.</span><span class="n">xml</span> <span class="o">/</span><span class="n">v</span><span class="p">:</span><span class="mi">13</span> <span class="o">/</span><span class="n">lae</span> <span class="o">/</span><span class="n">lac</span><span class="p">:</span><span class="mi">12345678</span> <span class="o">/</span><span class="n">decrypt</span> <span class="o">/</span><span class="n">key</span><span class="p">:</span><span class="n">delldakaren10</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>remova a opção /lae e /lac se a conta do perfil pertencer a um domínio. Use elas apenas para as contas locais. Saiba mais sobre esses e outros parâmetros em:  <a class="reference external" href="https://docs.microsoft.com/en-us/windows/deployment/usmt/usmt-loadstate-syntax">https://docs.microsoft.com/en-us/windows/deployment/usmt/usmt-loadstate-syntax</a> ou <a class="reference external" href="https://blogs.technet.microsoft.com/askds/2011/05/05/usmt-and-u-migrating-only-fresh-domain-profiles/">https://blogs.technet.microsoft.com/askds/2011/05/05/usmt-and-u-migrating-only-fresh-domain-profiles/</a></p>
</div>
<ol class="arabic simple" start="3">
<li><p>Desconecte o hd externo e reinicie o computador. Faça um logon com o usuário karen e veja se tudo está ok (email, imagens, documentos, favoritos, icones, atalhos e etc..)</p></li>
</ol>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">User State Migration Tool ‘USMT’</a><ul>
<li><a class="reference internal" href="#procedimento">Procedimento</a></li>
<li><a class="reference internal" href="#instalar-o-usmt">Instalar o USMT</a></li>
<li><a class="reference internal" href="#iniciar-o-processo-do-usmt-na-maquina-alvo">Iniciar o processo do usmt na máquina alvo</a></li>
</ul>
</li>
<li><a class="reference internal" href="#consideracoes-finais">Considerações Finais</a></li>
<li><a class="reference internal" href="#veja-um-exemplo-abaixo">Veja um exemplo abaixo</a><ul>
<li><a class="reference internal" href="#realizar-a-copia-critografada-do-perfil-completo-da-maquina">Realizar a cópia critografada do perfil completo da máquina.</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="juniper.html"
                          title="previous chapter">Router Juniper</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="bash.html"
                          title="next chapter">Dicas de bash, linha de comando para uso diário.</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/usmt.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="bash.html" title="Dicas de bash, linha de comando para uso diário."
             >next</a> |</li>
        <li class="right" >
          <a href="juniper.html" title="Router Juniper"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Base de Conhecimento 0.0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">User State Migration Tool ‘USMT’</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Tyuatsu.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
  </body>
</html>